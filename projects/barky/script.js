const url=document.getElementById("url-form"),bark=document.getElementById("bark"),target=document.getElementById("txt-body2"),element=document.getElementById("scrl"),quotaTarget=document.getElementById("quota");function isJson(t){t="string"!=typeof t?JSON.stringify(t):t;try{t=JSON.parse(t)}catch(t){return!1}return"object"==typeof t&&null!==t}window.onload=(async()=>{firebase.initializeApp({apiKey:"AIzaSyB7SNfMW1aW_F9JJZmq4-3oKZDFnDcKB0M",authDomain:"barky-f97f2.firebaseapp.com",projectId:"barky-f97f2",storageBucket:"barky-f97f2.appspot.com",messagingSenderId:"861040970376",appId:"1:861040970376:web:79032d713b0d9985fead3d",measurementId:"G-ZG01J73CDE"});const t=firebase.firestore(),e=await t.collection("users").doc(await biri()).get(),a=e.exists?e.data():{quota:100};quotaTarget.innerHTML=a.quota.toLocaleString()+" Q",e.exists||t.collection("users").doc(await biri()).update({quota:100}),bark.addEventListener("click",async e=>{if(e.preventDefault(),a.quota<=0)return alert("You don't have enough data for the day!\nDaily Quota resets at 9am UTC");fetch(url.value,{method:"GET"}).then(async e=>{const o=e.headers.get("content-type")&&-1!==e.headers.get("content-type").indexOf("text/plain")?await e.text():await e.json(),n=isJson(o)?JSON.stringify(o,void 0,2):o;target.innerHTML=n,a.quota-=1,quotaTarget.innerHTML=a.quota.toLocaleString()+" Q",t.collection("users").doc(await biri()).update({quota:a.quota}),window.scrollTo({top:760})})})});
