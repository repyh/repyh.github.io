const text = document.querySelector('.text');
const input = document.querySelector('.input');
let word = generateWord(12);
const startButton = document.querySelector('.start');
const type = document.querySelector('.type');
let correctWords = [];
let currentWord = "";
let currentTarget;
let resetCount = 0;
let timer = 60;

console.log(word)
window.onload = () => {
    setup();
}

function init() {
    input.disabled = false;
    input.focus();
    startButton.remove();

    const interval = setInterval(() => {
        timer--;
        document.querySelector('.timer').innerHTML = timer;
    }, 1000)

    setTimeout(() => {
        clearInterval(interval);
        document.querySelector('.timer').innerHTML = 0;
        input.disabled = true;
        type.innerHTML += `\n<button class="btn btn-primary start" disabled>Your WPM - ${correctWords.length}</button>\n<button class="btn btn-primary start" onclick="location.reload()">Restart</button>`;
    }, 60000)
}

function onInput() {
    const char = input.value.charAt(input.value.length-1);
    const charIndex = input.value.length-1;
    
    if(char === " ") input.value = input.value.replace(/ /g, "");

    if(currentTarget.charAt(charIndex) === char) {
        currentWord += char;
        if(currentTarget.length === input.value.length) {
            input.value = "";
            correctWords = [...correctWords, currentWord];
            
            document.querySelector(`#${currentTarget}`).classList.add('blue');

            currentTarget = text.innerHTML.split(/<\/span>/g).map(w => w.slice(w.indexOf('>')+1))[correctWords.length-(12*resetCount)];

            if(correctWords.length % 12 === 0 && correctWords.length !== 0) {
                word = generateWord(12);
                resetCount++;
                setup();
            }
        }
    }
}

function setup() {
    let addString = "";
    for(let i = 0; i < word.split(' ').length; i++) {
        addString += `<span id="${word.split(' ')[i]}">${word.split(' ')[i]}</span> `;
    }
    text.innerHTML = addString;
    currentTarget = text.innerHTML.split(/<\/span>/g).map(w => w.slice(w.indexOf('>')+1))[correctWords.length-(12*resetCount)];
}

function generateWord(amt) {
    const words = ["band","individual","angle","helpful","draw","smell","floating","thus","tired","pass","plastic","capital","disease","am","thank","son","trade","pain","edge","locate","appearance","pink","door","rather","length","hurry","house","adult","whispered","baby","may","tool","protection","clock","well","save","swung","gain","other","population","cabin","cannot","nuts","bottom","yellow","fast","harder","uncle","whom","electricity","soap","everywhere","regular","guard","thread","beat","sad","gave","closer","mail","teach","addition","vertical","universe","morning","factor","gather","storm","image","exciting","steam","story","that","cat","hollow","signal","two","taste","contrast","may","cotton","unusual","excitement","black","leg","ten","invented","tobacco","or","tongue","silk","broad","hunter","shape","taught","thus","chain","knowledge","drove","inside","invented","push","cowboy","page","machine","say","chance","taste","discovery","gray","hot","carbon","did","shine","property","mean","silly","line","plus","pound","make","waste","am","sense","flame","father","how","shout","per","iron","travel","result","source","stood","wife","rest","brought","him","that","region","occur","plain","per","rays","income","fifth","stared","you","stronger","prove","heart","language","lion","black","distant","twice","occur","appropriate","depth","river","compass","partly","person","entirely","life","beyond","wise","cabin","shelf","vote","tank","title","station","keep","yellow","rhythm","would","practical","plant","break","dirt","bridge","plate","measure","frequently","mark","thick","came","toward","fed","men","anywhere","poem","weak","surface","getting","forty","bee","stop","voice","stiff","sat","laid","won","fairly","cup","wave","whatever","guard","now","field","chicken","sick","product","silk","travel","east","animal","tide","exercise","aloud","spent","phrase","might","get","would","swung","yes","century","stiff","stuck","dust","steam","harder","slipped","elephant","chart","environment","six","pay","jet","either","baseball","happily","strength","empty","identity","path","guard","tiny","fine","cool","yourself","given","adventure","better","facing","electricity","anywhere","largest","prove","position","doubt","kept","run","begun","note","easier","till","right","printed","planet","human","writing","replied","fallen","equipment","now","hearing","cool","vertical","tall","unhappy","stream","giving","born","rope","early","calm","clothes","but","cake","elephant","reach","perfectly","dried","couple","college","indicate","circus","poem","damage","hair","mill","so","hill","ship","suggest","bark","native","cloth","alone","than","smallest","rice","force","statement","stay","piano","four","safe","boat","since","diameter","shoot","mighty","box","moving","especially","important","gone","spin","forty","traffic","foot","student","clock","body","principle","lips","struggle","specific","bite","furniture","practice","swing","period","fifty","die","cap","silly","smallest","road","house","even","beginning","wait","border","happily","cotton","door","beat","century","why","fish","selection","air","variety","whole","progress","importance","daughter","park","neighbor","bow","live","check","sing","policeman","treated","chicken","anywhere","good","daily","involved","promised","where","visitor","six","battle","drop","operation","courage","specific","cry","create","shut","power","adult","member","boy","degree","effort","simple","sat","climb","sight","cut","total","last","tip","change","setting","poet","alike","dead","himself","look","brown","signal","globe","action","task","fish","anything","high","strange","mostly","rush","twice","water","small","particles","sitting","written","death","per","mostly","do","told","wolf","treated","late","swam","school","straw","stranger","type","noted","those","tribe","road","century","nothing","strike","poetry","typical","tail","butter","wide","at","teeth","close","garage","zipper","problem","service","for","highway","stairs","boy","song","good","said","even","division","announced","rabbit","soon","work","notice","show","hello","afraid","one","gasoline","pupil","bill","few","whatever","born","pot","low","mood","what","history","seen","dish","telephone","upward","later","slave","spirit","cowboy","grow","instrument","done","had","bark","printed","rich","end","building","size","blanket","gas","horse","highway","throat","equal","open","sheet","choose","just","proper","largest","girl","comfortable","classroom","those","cross","industrial","call","cage","star","use","village","thumb","they","enemy","accident","condition","for","earth","hall","track","nails","shore","burn","nails","mental","wood","package","lower","object","railroad","birthday","indeed","part","control","army","dish","expect","beat","drove","stuck","oil","community","course","food","pole","policeman","could","automobile","furniture","minerals","drew","again","happened","practical","write","market","believed","neck","lying","promised","title","cat","known","running","hollow","question","college","extra","question","ask","occur","nuts","transportation","city","date","finest","shine","alone","getting","needle","west","sad","willing","correct","brief","usually","printed","differ","indicate","vowel","distant","flight","through","tool","machinery","date","consonant","jack","property","degree","finish","total","upward","customs","coast","production","lose","state","shoe","tightly","fell","peace","son","earlier","upon","saddle","obtain","zero","plus","damage","metal","many","mighty","science","air","nature","closely","shall","tape","difference","hurry","captain","valley","guard","fun","jump","accident","adventure","darkness","country","balloon","drove","particular","serious","invented","special","limited","coming","said","cheese","decide","four","anyone","whale","whenever","move","pictured","airplane","valuable","coffee","son","depend","fifteen","month","seems","sense","subject","foot","camera","swim","bow","brother","screen","merely","speed","size","whether","wish","him","land","father","hungry","second","shoot","coat","tax","safety","stock","string","changing","busy","listen","loss","frozen","office","breakfast","raise","best","excellent","second","telephone","unhappy","favorite","keep","wide","pass","wish","seven","her","longer","handsome","thrown","pie","speed","doing","widely","everybody","careful","deep","ought","took","pattern","court","lungs","doubt","them","sign","shoulder","syllable","farm","usually","nice","location","jet","line","onto","told","box","swimming","nervous","north","twelve","since","mood","fill","factor","tin","safe","tobacco","skill","love","center","rise","specific","memory","telephone","crowd","mirror","count","any","center","against","gas","worth","writer","better","spite","breathing","generally","perfect","mad","impossible","firm","plane","shake","as","tears","condition","usual","goes","poet","article","trunk","complex","else","knew","teeth","palace","slip","tight","tip","kill","composed","name","sale","list","opportunity","experiment","limited","dig","food","outside","pen","education","round","border","like","worker","least","teeth","wait","pond","remarkable","memory","sides","require","process","behind","gift","suggest","raise","everywhere","pocket","upper","occasionally","enter","charge","gone","silver","am","exclaimed","manufacturing","examine","fox","softly","run","locate","minerals","share","will","becoming","sale","yourself","hurried","closer","depend","produce","natural","unusual","correctly","up","organized","may","chest","toy","surprise","below","dug","separate","goes","welcome","production","silence","melted","ever","line","third","frighten","feel","naturally","property","huge","where","particular","improve","speak","cat","describe","voyage","quarter","if","battle","thought","provide","excellent","donkey","surface","tail","gain","vapor","discovery","husband","relationship","visit","solar","buy","particular","law","become","your","increase","tonight","plane","blue","youth","sweet","believed","blood","kept","gone","army","everyone","leaving","relationship","egg","stranger","wool","west","something","think","yes","neck","east","basket","according","easier","religious","upper","away","having","parent","came","nodded","total","lonely","term","halfway","plane","definition","trade","represent","hurried","diagram","setting","lamp","door","mission","feed","perhaps","folks","balloon","brief","arm","cannot","property","gasoline","food","birth","rain","night","grade","flame","electric","diagram","scientific","smooth","keep","chain","afraid","any","seed","hunt","repeat","mass","perhaps","available","rope","develop","statement","broad","recent","drove","cave","verb","transportation","rate","like","high","eaten","nails","sunlight","smallest","unless","actual","same","scale","finally","oxygen","bound","being","lion","introduced","fear","orbit","enjoy","watch","monkey","happy","object","happened","screen","our","orbit","boy","trade","distance","glass","receive","brief","threw","just","stand","smooth","taken","seed","making","treated","manufacturing","spell","tropical","sweet","blew","airplane","previous","wool","sing","watch","happened","truck","earlier","plant","note","end","dot","basis","sugar","means","captain","brass","hello","engineer","bean","eleven","position","skin","yard","support","trunk","girl","bat","standard","saw","no","zipper","frozen","sang","favorite","bottle","spell","two","complete","far","review","fifth","sang","school","everyone","hope","physical","scientist","lake","beautiful","vapor","mix","complete","light","upward","start","planet","spirit","dog","strike","shake","station","standard","lake","hearing","dinner","take","suggest","fear","spoken","powder","pretty","spider","week","rubber","funny","long","nice","composition","best","author","important","heading","simply","yes","common","board","independent","differ","weigh","sat","let","load","roof","somewhere","ran","clean","apple","thee","pole","anyone","activity","feed","region","continued","soap","powerful","shells","position","opportunity","parallel","stomach","slope","railroad","wait","opposite","laugh","skill","stomach","atom","farmer","behavior","slip","army","corn","fix","protection","young","air","continued","usually","level","make","although","regular","feathers","desert","plastic","combine","rocky","if","love","middle","given","entire","paragraph","actually","dish","anyone","anything","continent","giant","living","bite","related","stems","bent","first","pass","rhythm","property","tip","running","needle","bush","those","replied","half","taken","thy","song","fifteen","nice","girl","divide","car","fun","aloud","next","ourselves","golden","funny","from","minerals","according","my","poet","individual","settle","book","shut","close","recall","practice","since","butter","service","trade","knowledge","under","taught","president","beside","making","east","gold","television","breakfast","news","package","invented","slight","yesterday","corner","congress","apartment","jump","every","nine","meat","rhyme","alone","trouble","per","sunlight","average","sum","brought","everywhere","see","mirror","movement","time","farmer","wrapped","lake","popular","steady","sudden","tobacco","energy","blood","war","view","sand","search","aware","twice","shore","region","thrown","somehow","well","hall","fast","perfect","grew","caught","well","alphabet","character","close","mine","bell","private","own","policeman","setting","pride","weight","period","struck","nearby","deer","load","hearing","standard","eight","behind","west","equal","engineer","minerals","vegetable","instrument","tank","seems","breathe","learn","dance","gradually","chair","discover","cross","inch","usually","boy","whale","movement","one","pen","driven","curious","sometime","baby","equal","ocean","stairs","molecular","system","simply","remarkable","pound","among","yet","fast","continent","rope","sure","copy","jack","author","play","leg","from","hand","asleep","middle","aid","road","basic","citizen","suit","stood","call","jump","corn","steep","man","cage","drive","dust","broad","fresh","goose","traffic","spring","bag","drove","trap","back","minute","needle","know","wore","now","nature","anywhere","thirty","apartment","clothing","year","traffic","willing","six","slow","dried","coast","problem","shadow","escape","monkey","conversation","baby","tape","main","trick","cave","company","figure","hide","exact","cattle","lips","top","someone","mill","bowl","transportation","post","clay","riding","noon","whale","rain","hair","song","medicine","his","building","spin","article","member","was","quickly","save","window","tune","bee","combine","melted","deeply","prepare","airplane","wrapped","consonant","angle","policeman","reader","broad","red","opportunity","broad","tight","kill","river","entirely","freedom","there","five","hang","blow","basis","border","wash","pain","express","low","fighting","fact","attempt","morning","percent","beneath","army","complete","home","car","does","business","tone","fuel","zoo","like","replace","success","dawn","nails","touch","fruit","useful","detail","furniture","bell","help","necessary","machine","raw","busy","poem","heavy","shelter","event","ground","noon","draw","born","folks","machinery","interest","cast","similar","rule","pole","hope","till","ice","bring","water","actual","aboard","result","forgotten","trace","border","giant","sad","attempt","should","hurt","topic","additional","rule","nearer","comfortable","follow","previous","baby","band","blew","jar","handle","dish","piece","dance","depend","thought","opinion","apart","machinery","eight","immediately","powerful","leave","new","bear","medicine","key","inside","fill","trick","box","food","putting","flower","universe","local","missing","model","trace","lift","drink","rabbit","globe","different","lie","object","smoke","other","four","organized","type","nearest","me","ocean","sheet","difference","town","volume","properly","love","calm","regular","strong","poor","underline","ago","vertical","man","dream","in","pound","muscle","valley","spend","trace","repeat","rocket","fast","away","wash","gone","transportation","close","end","card","anybody","direction","thou","them","shoot","avoid","cell","so","special","canal","sun","string","learn","nine","week","out","speak","verb","sense","think","noted","hide","stove","letter","brave","fuel","coach","crop","pull","greater","say","comfortable","split","family","women","rest","cent","you","quarter","syllable","bound","enemy","later","why","rod","recently","everywhere","familiar","not","become","asleep","shoot","immediately","found","children","gasoline","receive","dust","jar","good","leaf","orange","measure","bound","compound","worry","was","stream","native","told","globe","swing","modern","fight","pine","lovely","south","entire","stick","brother","sugar","trace","affect","train","evidence","pink","program","children","tank","affect","community","ruler","highway","step","develop","grass","buy","lovely","heavy","letter","without","prepare","cross","breath","research","life","beat","wall","market","nodded","surprise","rice","chosen","burn","he","help","soldier","many","mountain","sand","brave","party","cook","equal","solar","branch","wish","arrange","lucky","wet","this","lie","proper","more","children","winter","coffee","motion","cover","dot","needs","watch","porch","strength","pattern","wheat","dress","article","thy","exclaimed","adventure","frog","compare","laugh","mixture","soap","thumb","exciting","being","suit","track","pie","desert","individual","important","score","shade","allow","dish","degree","combination","observe","city","blood","thought","essential","duck","require","either","electric","hard","tide","held","characteristic","garden","film","burn","represent","moon","pole","sister","record","shut","adult","torn","dress","forgot","mice","she","nearest","teach","away","sit","garage","mix","lose","ask","myself","yes","silent","truck","dozen","forest","private","because","party","now","enjoy","drove","close","palace","wash","develop","wet","practical","strong","my","cage","pile","rubbed","work","now","maybe","she","clock","comfortable","atom","won","thing","highway","call","enjoy","successful","dry","signal","factor","getting","upward","twelve","stove","space","paper","through","customs","happily","recall","enemy","should","interior","actually","pass","weak","pretty","minerals","note","tax","proper","jet","west","cave","from","origin","count","bet","soon","close","school","properly","they","stiff","told","lady","surprise","plane","charge","value","shut","ice","policeman","listen","local","area","sad","ship","hang","passage","light","thrown","society","rush","box","widely","snake","parallel","zipper","cat","lay","motion","handle","pull","pair","excited","afternoon","pride","sharp","other","kill","donkey","gun","cream","huge","ball","bush","someone","struck","hospital","vegetable","some","known","roll","noise","husband","bet","pet","terrible","easier","duty","flow","met","surface","movie","fifth","pound","careful","consist","final","camera","get","gone","progress","largest","bear","research","strength","season","stone"]
    let final = "";
    for(let i = 0; i < amt; i++) {
        final += capitalize(words[Math.floor(Math.random()*words.length)]) + " ";
    }
    function capitalize(str) {
        return str.charAt(0).toUpperCase() + str.slice(1);
    }
    return final;
}
